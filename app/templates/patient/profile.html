{% extends 'base.html' %}
{% from 'components/ui.html' import card, section_title, label, input, btn %}
{% block content %}
  {% call card(cls='p-6 max-w-4xl') %}
    <form method="post" class="space-y-6">
      <div>
        {{ section_title('Personal details') }}
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4">
          <div>
            {{ label('name', 'Full name') }}
            {{ input('name', 'name', value=(current_user.name or ''), placeholder='Your name') }}
          </div>
          <div>
            {{ label('phone', 'Phone') }}
            {{ input('phone', 'phone', value=(current_user.phone or ''), type='tel', placeholder='+91...') }}
          </div>
          <div>
            {{ label('dob', 'Date of birth') }}
            {{ input('dob', 'dob', value=(patient.dob or ''), placeholder='YYYY-MM-DD') }}
          </div>
          <div>
            {{ label('gender', 'Gender') }}
            {{ input('gender', 'gender', value=(patient.gender or ''), placeholder='e.g., Female') }}
          </div>
        </div>
      </div>

      <div style="border-top: 1px solid var(--border-secondary);" class="pt-6">
        {{ section_title('Emergency details') }}
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4">
          <div>
            {{ label('blood_group', 'Blood group') }}
            {{ input('blood_group', 'blood_group', value=(patient.blood_group or ''), placeholder='e.g., O+') }}
          </div>
          <div>
            {{ label('allergies', 'Allergies') }}
            {{ input('allergies', 'allergies', value=(patient.allergies or ''), placeholder='e.g., Penicillin') }}
          </div>
        </div>

        <div class="mt-4">
          {{ label('chronic_conditions', 'Chronic conditions') }}
          {{ input('chronic_conditions', 'chronic_conditions', value=(patient.chronic_conditions or ''), placeholder='e.g., Asthma') }}
        </div>

        <div class="mt-4">
          {{ label('emergency_contacts', 'Emergency contacts') }}
          {{ input('emergency_contacts', 'emergency_contacts', value=(patient.emergency_contacts or ''), placeholder='Name, relation, phone') }}
        </div>
      </div>

      <div class="flex items-center gap-2">
        {{ btn('Save changes', icon_name='solar:diskette-linear', variant='primary', type='submit') }}
        {{ btn('Emergency-only page', icon_name='solar:heart-pulse-linear', href=url_for('patient.emergency_profile'), variant='soft') }}
      </div>
    </form>
  {% endcall %}
{% endblock %}
